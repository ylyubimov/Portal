@model Portal.Models.Article

<div class="container article-wrap">
    <div class="article-preview">
        <div class="article-header">
            <a class="author no-link-attributes" href=@Url.Action("person", "persons", new { @id = Model.Author.Id}) >
                <img class="img-circle" src=@Model.Author.Picture.URL />
                @Model.Author.First_Name @Model.Author.Second_Name
            </a>
            <div class="date">@Model.Date_of_Creation</div>
            <div class="article-actions">
                @if (User.Identity.Name != "")
                {
                    if (Model.Dislikes_Authors.Where(p => p.UserName == User.Identity.Name).FirstOrDefault() != null)
                    {
                        <div class="rating">
                            <div class="rating-plus" style="opacity: 0.4;" onClick="OnLikeClick('@Url.Action("LikeArticle", "Articles", new { @id = Model.ID })', '@Model.ID')" id=@("LikesCountOnClick" + Model.ID)>
                                <img class="icon" src="~/images/icons/plusIcon.png" /><span id=@("LikesCount" + Model.ID)>@Model.Likes_Count</span>
                            </div>
                            <div class="rating-minus" style="opacity: 1;" onClick="OnDislikeClick('@Url.Action("DislikeArticle", "Articles", new { @id = Model.ID })', '@Model.ID')" id=@("DislikesCountOnClick" + Model.ID)>
                                <img class="icon" src="~/images/icons/minusIcon.png" /><span id=@("DislikesCount" + Model.ID)>@Model.Dislikes_Count</span>
                            </div>
                        </div>
                    }
                    else if (Model.Likes_Authors.Where(p => p.UserName == User.Identity.Name).FirstOrDefault() != null)
                    {
                        <div class="rating">
                            <div class="rating-plus" style="opacity: 1;" onClick="OnLikeClick('@Url.Action("LikeArticle", "Articles", new { @id = Model.ID })', '@Model.ID')" id=@("LikesCountOnClick" + Model.ID)>
                                <img class="icon" src="~/images/icons/plusIcon.png" /><span id=@("LikesCount" + Model.ID)>@Model.Likes_Count</span>
                            </div>
                            <div class="rating-minus" style="opacity: 0.4;" onClick="OnDislikeClick('@Url.Action("DislikeArticle", "Articles", new { @id = Model.ID })', '@Model.ID')" id=@("DislikesCountOnClick" + Model.ID)>
                                <img class="icon" src="~/images/icons/minusIcon.png" /><span id=@("DislikesCount" + Model.ID)>@Model.Dislikes_Count</span>
                            </div>
                        </div>
                    }
                    else
                    {
                        <div class="rating">
                            <div class="rating-plus" onClick="OnLikeClick('@Url.Action("LikeArticle", "Articles", new { @id = Model.ID })', '@Model.ID')" id=@("LikesCountOnClick" + Model.ID)>
                            <img class="icon" src="~/images/icons/plusIcon.png" /><span id=@("LikesCount" + Model.ID)>@Model.Likes_Count</span>
                            </div>
                            <div class="rating-minus" onClick="OnDislikeClick('@Url.Action("DislikeArticle", "Articles", new { @id = Model.ID })', '@Model.ID')"  id=@("DislikesCountOnClick" + Model.ID)>
                            <img class="icon" src="~/images/icons/minusIcon.png" /><span id=@("DislikesCount" + Model.ID)>@Model.Dislikes_Count</span>
                            </div>
                        </div>
                    }
                }
                @if (User.Identity.Name == Model.Author.UserName || User.IsInRole("admin"))
                {
                <div class="article-settings dropdown">
                    <div class="article-settings-btn" data-toggle="dropdown"><img class="icon" src="~/images/icons/settingsIcon.png" />Actions</div>
                    <ul class="dropdown-menu article-settings-menu">
                        <li><img class="icon" src="/images/icons/settignsPointIcon.png" />@Html.ActionLink("Delete", "Delete", "Articles", new { @id = Model.ID }, new { @class = "" })</li>
                        <li><img class="icon" src="/images/icons/settignsPointIcon.png" />@Html.ActionLink("Edit", "Edit", "Articles", new { @id = Model.ID }, new { @class = "" })</li>
                    </ul>
                </div>
                }
            </div>
        </div>
        <h3>@Model.Name</h3>
        <p>@Model.Text.Substring(0, (Model.Text.Length > 500) ? 500 : Model.Text.Length)...</p>
        <a>@Html.ActionLink("Read more...", "Index", "Articles", new { @id = Model.ID }, new { @class = "" })</a>
    </div>
</div>
